<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<html>

<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<title>Java Apache Mail Enterprise Server</title>
</head>

<body BGCOLOR="#FFFFFF">
<!--
<h2 align="center"><img SRC="images/java-apache-project.gif" BORDER="0" HEIGHT="100"
WIDTH="609"></h2>
-->
<h3 align = left><a href="index.html">Up to Index</a></h3>
<h1 align="center">Using LDAP as a Users Repository</h1>
<h4 align="center">JAMES 1.2</h4>

<h3>Summary</h3>
<blockquote>
    <p>This document explains how to enable JAMES to use an LDAP directory as a Users Repository</p>
</blockquote>


<h3>Summary</h3>
<blockquote>
    <p>We have tried to make the LDAP implementation of UsersRepository as flexible a possible, recognising that each installation will have a unique directory schema.</p>
    <p>We assume that all users that a James Mailserver will handle fall within one single-rooted tree. The root of this tree, ie the lowest node in the directory which is an ancestor for all users served by this mailserver and the mailserver, is called the LDAPRoot. (See diagram)</p>
    <p>It is entirely possible that an organization may have more than one mail server. Consequently, the fact that a user is in the Directory does not imply that this mailserver should handle mail for them.
    <p>This implementation of UsersRepository creates one node (object) for each set of mail users. The set called 'LocalUsers' is the set of users whose mail is handled by this server. Other sets include any mail-lists handled by the server. Each member of a set is recorded as an attribute of these objects. These nodes are child nodes of the mailserver.
    <p>The mailserver will accept mail for local delivery if the user part of the email address matches a member of LocalUsers and if the domain/host part of the email address matches the first servername . (Set servernames autodetect to false and enter the domain served as the first servername, e.g. apache.org).
    <p>For POP3 authentication, the mailserver first finds the user entry in the directory, underLDAPRoot, whose attribute, specified as MailAttribute in conf, matches user@domain. The mailserver authenticates the POP3 user if it can bind to the directory as that user entry with the offered password.
    <p>This implementation does not set passwords in the directory. Use a dummy password when invoking adduser in RemoteManger.
    <p>If ManageGroupAttribute is set to TRUE (as it is by default), then the RemoteManger will add/remove the full DN of the email group to/from the user entry. This facilty allows users to ask the directory what is my mailserver and what email lists am I subscribed to?
</blockquote>


<h3>Diagram</h3>
<table cellspacing=0>
<tr>
<td> </td>
<td align="center">Root of Directory<br>Example: dc=org<br>May not be referenced in conf.xml<br>|<br>|</td>
<td> </td>
</tr>
<tr>
<td colspan=3 align="center">-------------------------------------------------------------------------------------------------</td>

</tr>
<tr>
<td align="center" valign="top">|<br>Subtree not served by James<br> e.g.: dc=w3c, dc=org </td>
<td align="center" valign="top">|<br>Subtree served by James<br> e.g.: dc=apache, dc=org <br>"LDAPRoot"<br>|</td>

<td align="center" valign="top">|<br>Subtree not served by James<br> e.g.: dc=xml, dc=org </td>
</tr>
<tr>
<td> </td>
<td>
    <table cellspace=0>
    <tr>
    <td colspan=4 align="center">----------------------------------------------------</td>
    </tr>
    <td align="center" valign="top">|<br>This mailserver <br>cn=mailserver.apache.org<br>|<BR>---------------</td>
    <td align="center" valign="top">|<br>A user <br>cn=King Arthur<br> memberOfGroup=<br>cn=LocalUsers etc </td>
    <td align="center" valign="top">|<br>A user <br>cn=Morgan LeFay </td>
    <td align="center" valign="top">|<br>Another mailserver <br>cn=oldmail.apache.org</td>
    <tr>
    <td>
        <table cellspace=0>
	<tr>
	<td align="center" valign="top"> |<br>LocalUsers<br>member=Arthur</td>
	<td align="center" valign="top"> |<br>list-james<br>member=Arthur</td
	</tr>
	</table>
    </td>
    <td> </td>
    <td> </td>
    <td> </td>
    </tr>
    </table>
</td>
<td> </td>

</table>

<p align="center">
<p align="center">
<p align="center">
<p align="center">
<p align="center">

<h3>Installation</h3>
<blockquote>
    <p>Six  entries in JAMES.conf.xml must be set for this to work:</p>
<ul>
<li>change usersManager - type to ldap.
<li>Set the ldapServer element to point to the correct host and port
<li>Set LDAPRoot and ThsServerRDN.
<li>Set the direcory FDN and password that should be used to write to the directory.
<li>Unless all your users have email addresses of the form, name@the-machine-running-James, set servernames-autodetect to false and apecify the your email domain as the first servername.
</ul>
<h3 align = left><a href="index.html">Up to Index</a></h3>
<p align="center"><font SIZE="-1">Copyright (c) 1997-2000 <a HREF="http://java.apache.org">The
Java Apache Project</a>.<br>
All rights reserved.</font></p>

</body>
</html>