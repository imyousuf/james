<!--
  Licensed to the Apache Software Foundation (ASF) under one   
  or more contributor license agreements.  See the NOTICE file 
  distributed with this work for additional information        
  regarding copyright ownership.  The ASF licenses this file   
  to you under the Apache License, Version 2.0 (the            
  "License"); you may not use this file except in compliance   
  with the License.  You may obtain a copy of the License at   
                                                               
    http://www.apache.org/licenses/LICENSE-2.0                 
                                                               
  Unless required by applicable law or agreed to in writing,   
  software distributed under the License is distributed on an  
  "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY       
  KIND, either express or implied.  See the License for the    
  specific language governing permissions and limitations      
  under the License.                                           
 -->
<!-- The configuration handler chain -->
<!-- Please note that this is EXPERIMENTAL and will be changed in future -->
<!-- releases -->
<handlerchain> 

    <!-- This connect handler can be used to enable POP3 before SMTP support -->
    <!-- Plz note that only the ip get stored to indentify an authenticated client -->
    <!-- The expireTime is the time after which an ipAddress is handled as expired -->
    <!--
    <handler class="org.apache.james.smtpserver.core.POP3BeforeSMTPHandler">
        <expireTime> 1 hour </expireTime>
    </handler>
    -->
            
    <!-- This command handler check against RBL-Lists -->
    <!-- If getDetail is set to true it try to retrieve information from TXT Record -->
    <!-- why the ip was blocked. Default to false -->            
    <!-- STOP - before you uncomment out the DNS RBL handler,
         please take a moment to review each block list.  We
         have included some that various JAMES committers use,
         but you must decide which, if any, are appropriate
         for your environment.  The mail servers hosting
         @apache.org mailing lists, for example, use a
         slightly different list than we have included below.
         And it is likely that most JAMES committes also have
         slightly different sets of lists.  The SpamAssassin
         user's list would be one good place to discuss the
         measured quality of various block lists.

         NOTA BENE: the domain names, below, are terminated
         with '.' to ensure that they are absolute names in
         DNS lookups.  Under some circumstances, names that
         are not explicitly absolute could be treated as
         relative names, leading to incorrect results.  This
         has been observed on *nix and MS-Windows platforms
         by users of multiple mail servers, and is not JAMES
         specific.  If you are unsure what this means for you,
         please speak with your local system/network admins.
     -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.DNSRBLHandler">
         <getDetail> false </getDetail>
         <rblservers>
             <whitelist> query.bondedsender.org. </whitelist>

             <blacklist> sbl-xbl.spamhaus.org. </blacklist>
             <blacklist> dul.dnsbl.sorbs.net. </blacklist>
             <blacklist> list.dsbl.org. </blacklist>
         </rblservers>
     </handler>            
     --> 
     
     <!-- This command handler can be used to reject emails with not match the SPF record of the sender domain --> 
     <!-- If checkAuthNetworks is set to true sender domain will be checked also for clients that -->
     <!-- are allowed to relay. Default is false. -->  
     <!--
     <handler class="org.apache.james.smtpserver.integration.JamesSPFHandler">
         <checkAuthNetworks> false </checkAuthNetworks>
         <blockSoftFail> false </blockSoftFail>
         <blockPermError> true </blockPermError>
     </handler>
     -->    
            

     <!-- The filter handler configuration -->
     
     <!-- checks for resolvable HELO/EHLO before accept the HELO/EHLO -->
     <!-- If checkAuthNetworks is set to true sender domain will be checked also for clients that -->
     <!-- are allowed to relay. Default is false. -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.ResolvableEhloHeloHandler">
         <checkAuthNetworks> false </checkAuthNetworks>
         <checkAuthUsers> false </checkAuthUsers>
     </handler>  
     -->
            
     <!-- Checks HELO/EHLO is equal the reverse of the connecting client before accept it -->
     <!-- If checkAuthNetworks is set to true sender domain will be checked also for clients that -->
     <!-- are allowed to relay. Default is false. -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.ReverseEqualsEhloHeloHandler">
         <checkAuthClients> false </checkAuthClients>
         <checkAuthUsers> false </checkAuthUsers>
     </handler>
     -->
            
     <!-- If activated mail is only accepted if the sender contains -->
     <!-- a resolvable domain having a valid MX Record or A Record associated! -->
     <!-- If checkAuthNetworks is set to true sender domain will be checked also for clients that -->
     <!-- are allowed to relay. Default is false. -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.ValidSenderDomainHandler">
         <checkAuthClients> false </checkAuthClients>
         <checkAuthUsers> false </checkAuthUsers>
     </handler>
     -->
     
         
     <!-- If activated all email will get rejected which has no valid user -->
     <!-- You need to add the recipient to the validRecipient list if you want -->
     <!-- to accept email for a recipient which not exist on the server -->
     <!-- 
     <handler class="org.apache.james.smtpserver.integration.ValidRcptHandler">
         <validRecipients> </validRecipients>
         <validDomains> </validDomains>
         <validRegexPattern> </validRegexPattern>
     </handler>
     -->
            
     <!-- If activated you can limit the maximal recipients -->
     <!-- 
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.MaxRcptHandler">
         <maxRcpt> 10 </maxRcpt>                
     </handler>
     -->
            
     <!-- If uncomment this block you can enable greylisting. For more infos-->
     <!-- how greylisting work see: http://projects.puremagic.com/greylisting/whitepaper.html -->
     <!--
     <handler class="org.apache.james.smtpserver.integration.JDBCGreylistHandler">
         <repositoryPath> db://maildb </repositoryPath>
         <sqlFile>file://conf/sqlResources.xml</sqlFile>
         <tempBlockTime> 1 hour </tempBlockTime>
         <unseenLifeTime> 4 hours </unseenLifeTime>
         <autoWhiteListLifeTime> 36 days </autoWhiteListLifeTime>
         <whitelistedNetworks> 127.0.0.0/8 </whitelistedNetworks>
     </handler>
     -->
            
     <!-- Tarpitting is a method to insert a small sleep after each rcpt. For more -->
     <!-- infos read this: http://www.palomine.net/qmail/tarpit.html . -->
     <!-- Default is set to 0 (disabled). -->
     <!-- You can also configure the time to sleep in milliseconds -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.TarpitHandler">
         <tarpitRcptCount> 5 </tarpitRcptCount>
         <tarpitSleepTime> 5000 </tarpitSleepTime>
     </handler>
     -->
         
     <!-- This handler ignore duplicated recipients per session. So the email will get only send on time even -->
     <!-- if the recipient is specified more then once -->
     <!--
     <handler class="org.apache.james.smtpserver.protocol.core.fastfail.SuppressDuplicateRcptHandler"/>
     -->
     
     <!-- Load the core command handlers -->
     <handler class="org.apache.james.smtpserver.integration.CoreCmdHandlerLoader"/>        
      
     <!-- The message handler configuration -->
     
     <!-- This MessageHandler could be used to check message against spamd before -->
     <!-- accept the email. So its possible to reject a message on smtplevel if a -->
     <!-- configured hits amount is reached. -->
     <!--
     <handler class="org.apache.james.smtpserver.integration.SpamAssassinHandler">
         <spamdHost> 127.0.0.1 </spamdHost>
         <spamdPort> 783 </spamdPort>
         <spamdRejectionHits> 10 </spamdRejectionHits>
         <checkAuthNetworks> false </checkAuthNetworksv>
     </handler>
     -->
     
     <!-- This MessageHandler could be used to extract domain out of the message and check -->
     <!-- this domains against uriRbllists. See http://www.surbl.org for more informations. -->
     <!-- The message get rejected if a domain matched . -->
     <!--
     <handler class="org.apache.james.smtpserver.integration.URIRBLHandler">
         <action> reject </action>
         <getDetail> true </getDetail>
         <checkAuthNetworks> false </checkAuthNetworks>
         <uriRblServers> 
             <server> multi.surbl.org</server>
         </uriRblServers>
     </handler>
     -->
     
     <!-- 
     <handler class="org.apache.james.smtpserver.integration.SetMimeHeaderHandler">
         <headername>SPF-test</headername>
         <headervalue>passed</headervalue>
     </handler>
     -->
            
     <!--  The default message receiving handler -->
     <!--  The default behaviour is to put the message in the root processor of -->
     <!--  the spooler -->
     <handler class="org.apache.james.smtpserver.integration.SendMailHandler"></handler>
</handlerchain>
